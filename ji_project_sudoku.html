<!DOCTYPE html>
<html>

<head>
    <link rel="stylesheet" href="ji_styles.css">
</head>

<body style="background-image: url('background_placeholder_sudo.png')">
    <form class="max_width_and_height">
        <div style="text-align: center">
            <img style="height:8cm" src="sudo_placeholder.png">
        </div>
        <h1 style="text-align: center; margin-top:-6.5cm; margin-bottom: 3cm;">Sudoku Solver</h1>
        <div class="projects_div">
            <input class="projects" type="button" value="Home" onClick="window.location.href='ji_home.html'">
            <input class="projects" type="button" value="Perfect Pike Pattiy"
                onClick="window.location.href='ji_project_patties.html'">
            <input class="projects" type="button" value="Sudoku Analyzer"
                onClick="window.location.href='ji_project_sudoku.html'">
            <input class="projects" type="button" value="Ei käytössä"
                onClick="window.location.href='ji_project_temp.html'">
        </div>
        <br>
        <div class="search_div">
            <input type="text" id="search" placeholder="Search for pages!">
            <input type="button" value="Search" onClick="searchFor()">
        </div>
    </form>
    <form style="text-align: center">
        <div class="project_image">
            <img class="project_image" src="sudo_kuvat_placeholder.png
            ">
        </div>
        <div class="project_text" style="background-color:rgb(192, 192, 219)">
            <h1>Sudoku Analyzer</h1>
            This is a showcase for a recursive backtracking brute force sudoku solver algorithm. <br>
            In addition to the solver function, there are multiple helper functions for validation and printing but
            the interesting stuff is in the solver. <br>
            The original implemenetation I worked on was written in C for a group project, and this follows mostly the
            same logic translated into JavaScript.<br>
            It's the best known sudoku solver method and a good general showcase for a recursive backtracker.
        </div>
    </form>
    <form class="max_width">
        <div style="text-align: center;">
            <input type="button" value="Dispaly Algorithm Code" onClick="codeDisplay()">
        </div>
        <div style="background-color: powderblue">
            <pre id="codeDisplay" style="text-align: left;"></pre>
            <P style="text-align: center; background-color: powderblue">
            <h2 style="text-align: center">Explanation</h2>
            <ul style="background-color: powderblue">
                <li>The solver gets a single cell's coordinates as parameters and determines if that cell meets the
                    criteria
                    to call itself with next cell's coordinates</li>
                <li>The solver saves the currently looked at value 1-9 in the current cell before recursive call and
                    wipes it if a fail state is returned
                    <ul>
                        <li>This solves the issue of keeping track of the progress since any failed branch unravels into
                            its starter state</li>
                    </ul>
                </li>
                <li>The function goes through the cells until the sudoku has been confirmed having no solutions, having
                    more than 1 solution, or having exactly 1 solution</li>
                <li>At any of those points no further calls are made, and another function prints the sudoku status
                    based on
                    global vairables saved in key conditions during the solver calls
                    <ul>
                        <li>Solutions count: add +1 each time end condition is met up to 2</li>
                        <li>Solved sodoku: copy from the currently analyzed sudoku when end condition is met for the
                            first time</li>
                    </ul>
                </li>
            </ul>
            </P>
        </div>
        <div style="background-color:antiquewhite; padding-bottom:1cm; padding-top:1cm;">
        <p style="text-align: center;">
            <input type="text" id="i00" size="1">
            <input type="text" id="i01" size="1">
            <input type="text" id="i02" size="1">
            <input type="text" id="i03" size="1">
            <input type="text" id="i04" size="1">
            <input type="text" id="i05" size="1">
            <input type="text" id="i06" size="1">
            <input type="text" id="i07" size="1">
            <input type="text" id="i08" size="1">
            <br style="margin-bottom: 0.5em">
            <input type="text" id="i10" size="1">
            <input type="text" id="i11" size="1">
            <input type="text" id="i12" size="1">
            <input type="text" id="i13" size="1">
            <input type="text" id="i14" size="1">
            <input type="text" id="i15" size="1">
            <input type="text" id="i16" size="1">
            <input type="text" id="i17" size="1">
            <input type="text" id="i18" size="1">
            <br style="margin-bottom: 0.5em">
            <input type="text" id="i20" size="1">
            <input type="text" id="i21" size="1">
            <input type="text" id="i22" size="1">
            <input type="text" id="i23" size="1">
            <input type="text" id="i24" size="1">
            <input type="text" id="i25" size="1">
            <input type="text" id="i26" size="1">
            <input type="text" id="i27" size="1">
            <input type="text" id="i28" size="1">
            <br style="margin-bottom: 0.5em">
            <input type="text" id="i30" size="1">
            <input type="text" id="i31" size="1">
            <input type="text" id="i32" size="1">
            <input type="text" id="i33" size="1">
            <input type="text" id="i34" size="1">
            <input type="text" id="i35" size="1">
            <input type="text" id="i36" size="1">
            <input type="text" id="i37" size="1">
            <input type="text" id="i38" size="1">
            <br style="margin-bottom: 0.5em">
            <input type="text" id="i40" size="1">
            <input type="text" id="i41" size="1">
            <input type="text" id="i42" size="1">
            <input type="text" id="i43" size="1">
            <input type="text" id="i44" size="1">
            <input type="text" id="i45" size="1">
            <input type="text" id="i46" size="1">
            <input type="text" id="i47" size="1">
            <input type="text" id="i48" size="1">
            <br style="margin-bottom: 0.5em">
            <input type="text" id="i50" size="1">
            <input type="text" id="i51" size="1">
            <input type="text" id="i52" size="1">
            <input type="text" id="i53" size="1">
            <input type="text" id="i54" size="1">
            <input type="text" id="i55" size="1">
            <input type="text" id="i56" size="1">
            <input type="text" id="i57" size="1">
            <input type="text" id="i58" size="1">
            <br style="margin-bottom: 0.5em">
            <input type="text" id="i60" size="1">
            <input type="text" id="i61" size="1">
            <input type="text" id="i62" size="1">
            <input type="text" id="i63" size="1">
            <input type="text" id="i64" size="1">
            <input type="text" id="i65" size="1">
            <input type="text" id="i66" size="1">
            <input type="text" id="i67" size="1">
            <input type="text" id="i68" size="1">
            <br style="margin-bottom: 0.5em">
            <input type="text" id="i70" size="1">
            <input type="text" id="i71" size="1">
            <input type="text" id="i72" size="1">
            <input type="text" id="i73" size="1">
            <input type="text" id="i74" size="1">
            <input type="text" id="i75" size="1">
            <input type="text" id="i76" size="1">
            <input type="text" id="i77" size="1">
            <input type="text" id="i78" size="1">
            <br style="margin-bottom: 0.5em">
            <input type="text" id="i80" size="1">
            <input type="text" id="i81" size="1">
            <input type="text" id="i82" size="1">
            <input type="text" id="i83" size="1">
            <input type="text" id="i84" size="1">
            <input type="text" id="i85" size="1">
            <input type="text" id="i86" size="1">
            <input type="text" id="i87" size="1">
            <input type="text" id="i88" size="1">
        </p>
        <div class="align_center">
            <p style="color: blue">Alternative input: each row 9 characters, space separates the rows, press fill</p>
            <input type="text" id="fill" size="85">

        </div>

        <p style="padding-bottom: 1cm; text-align: center">
            <!--<input type="button" value="Print" onClick="printer(sudo)">
            <input type="button" value="Copy" onClick="copySudoku()">
            <input type="button" value="Print Copy" onClick="printer(sudoSolved)">-->
            <input type="button" value="Fill" onClick="filler()">
            <input type="button" value="Solver" onClick="readAndSolve()">
        </p>
        <div class="align_center" id="status"></div>
        <div class="align_center" id="sudoku"></div>
    </div>
    </form>
    <form>
        <div class="align_center">
            <input class="projects" type="button" value="Contact me!" onClick="window.location.href='ji_contact.html'">
            <input class="projects" type="button" value="Feedback" onClick="window.location.href='ji_guest.html'">
            <input class="projects" type="button" value="Home" onClick="window.location.href='ji_home.html'">

        </div>
    </form>

    <script src="ji_scripts.js"></script>
    <script>
        "use strict;"
        let solutions = 0;
        let sudo = [];
        let sudoSolved = [];
        let displaystatus = 0;
        //let testSudoku = "530070000 600195000 098000060 800060003 400803001 700020006 060000280 000419005 000080079"
        //let testSudokuSolved = "534678912 672195348 198342567 859761423 426853791 713924856 961537284 287419635 345286179"
        for (let i = 0; i < 9; i++) {
            sudo[i] = [];
            sudoSolved[i] = [];
        }

        reader();
        function solver(row, number) {
            let r = row;
            let n = number;
            let i = 1;
            if (n >= 9) {
                // console.log("Solver: line reset");
                n = 0;
                r++;
            }
            if (solutions > 1) {
                return 0;
            }
            if (r >= 9) {
                // console.log("Solver: success condition");
                copySudoku();
                solutions++;
                return 0;
            }
            else if (sudo[r][n] != 0) {
                // console.log("Solver filled cell recursive call")
                return (solver(r, n + 1));
            }
            else {
                while (i <= 9) {
                    //console.log("Solver while status: ", i);
                    sudo[r][n] = i;
                    if (valid(r, n) == 1) {
                        if (solver(r, n + 1) == 1) {
                            return 1;
                        }
                    }
                    sudo[r][n] = 0;
                    i++;
                }
            }
            // console.log("Solver: fail condition");
            return 0;
        }


        function readAndSolve() {
            let teksti;
            let lisa = ".";
            document.getElementById("sudoku").innerHTML = "";
            solutions = 0;
            reader();
            if (validate() == 1) {
                solver(0, 0);
            }
            else {
                lisa = " (invalid input)."
            }
            if (solutions == 1) {
                teksti = "Sudoku valid";
                printer(sudoSolved);
            }
            else if (solutions > 1) {
                teksti = "Sudoku invalid: multiple solutions";
                printer(sudoSolved);
            }
            else {
                teksti = "Sudoku invalid: no solutions";
                printer(sudo);
            }
            teksti = "<h1>" + teksti + lisa + "</h1>"
            document.getElementById("status").innerHTML = teksti;
        }

        function reader() {
            let i = 0;
            let l = 0;
            while (i < 9) {
                sudo[i][l] = document.getElementById("i" + i + l).value;
                if (sudo[i][l] >= 1 && sudo[i][l] <= 9) {
                    sudo[i][l] = Number(sudo[i][l]);
                }
                else {
                    sudo[i][l] = 0;
                }
                l++;
                if (l >= 9) {
                    i++;
                    l = 0;
                }
            }
        }

        function copySudoku() {
            let i = 0;
            let l = 0;

            while (i < 9) {
                if (l == 9) {
                    l = 0;
                    i++;
                    if (i == 9) {
                        break;
                    }
                }
                console.log("i: ", i, "l: ", l, "sudo: ", sudo[i][l]);
                sudoSolved[i][l] = sudo[i][l];
                l++;
            }
        }

        function printer(sudo) {
            let i = 0;
            let l = 0;
            let teksti = "<p>";
            while (i < 9) {
                if (l < 9) {
                    teksti = teksti + " | "
                }
                teksti = teksti + sudo[i][l];
                l++;
                if (l >= 9) {
                    teksti = teksti + " |<br>";
                    i++;
                    l = 0;
                }
            }
            teksti = teksti + "</p>"
            document.getElementById("sudoku").innerHTML = teksti;
        }
        function validate() {
            let i = 0;
            let l = 0;
            while (i < 9) {
                if (sudo[i][l] != 0) {
                    if (valid(i, l) == 0) {
                        // console.log("validation: fail");
                        return 0;
                    }
                }
                l++;
                if (l >= 9) {
                    l = 0;
                    i++;
                }
            }
            // console.log("validation: meni läpi");
            return 1;
        }
        function valid(row, number) {
            let i = 0;
            let l = 0;

            if (xAndY(row, number) != 1) {
                return 0;
            }
            return threeByThree(row, number)
        }
        function threeByThree(row, number) {
            let i;
            let l;
            let istart;
            let lstart;
            if (row <= 2) {
                i = 0;
            }
            else if (row <= 5) {
                i = 3;
            }
            else {
                i = 6;
            }
            if (number <= 2) {
                l = 0;
            }
            else if (number <= 5) {
                l = 3;
            }
            else {
                l = 6;
            }
            istart = i;
            lstart = l;
            //console.log("3by3 i = ", i);
            //console.log("3by3 l = ", l);
            while (i - istart < 3) {
                if (row != i || number != l) {
                    if (sudo[row][number] == sudo[i][l]) {
                        //console.log("3by3: failas");
                        return 0;
                    }
                }
                l++;
                if (l - lstart >= 3) {
                    l = lstart;
                    i++;
                }
            }
            //console.log("3by3: läpi meni")
            return 1;
        }
        function xAndY(row, number) {
            let i = row;
            let l = 0;
            while (l < 9) {
                if (sudo[row][number] == sudo[i][l] && l != number) {
                    //console.log("xAndY l-loop: failas");
                    return 0;
                }
                //console.log("L-loop status: ", l);
                l++;
            }
            i = 0;
            l = number;
            while (i < 9) {
                if (sudo[row][number] == sudo[i][l] && i != row) {
                    //console.log("xAndY i-loop: failas");
                    return 0;
                }
                //console.log("i-loop status: ", i)
                i++;
            }
            //console.log("xAndY: meni läpi")
            return 1;
        }
        function validTest() {
            let y = Number(document.getElementById("validRow").value);
            let x = Number(document.getElementById("validNumber").value);
            // console.log("Valid test: ", valid(y, x));
        }
        //            <input type="text" id="i00" size="1">
        function filler() {
            let i = 0;
            let l = 0;
            let counter = 0;
            let sudo = document.getElementById("fill").value.trim();
            while (i < 9) {
                if (sudo.charAt(counter) == " ") {
                    counter++;
                }
                document.getElementById("i" + i + l).value = sudo.charAt(counter);
                counter++;
                l++;
                if (l >= 9) {
                    l = 0;
                    i++;
                }
            }
        }

        function codeDisplay() {
            let teksti = "";

            if (displaystatus == 1) {
                displaystatus = 0;
            }

            else {
                displaystatus = 1;

                teksti =
                    "function solver(row, number) {     //solver(0, 0) for the first call<br>" +
                    "   let r = row;    //initializing some local variables<br>" +
                    "   let n = number;<br>" +
                    "   let i = 1;<br>" +
                    "   if (n >= 9) {   //row swap<br>" +
                    "       n = 0;<br>" +
                    "       r++;<br>" +
                    "   }<br>" +
                    "   if (solutions > 1) {    //more than one solution = invalid sudoku<br>" +
                    "       return 0;<br>" +
                    "   }<br>" +
                    "   if (r >= 9) {   //solution found<br>" +
                    "       copySudoku();    //calling helper function to save the solution<br>" +
                    "       solutions++;    //+1 to solutions counter<br>" +
                    "       return 0;   //returns fail state to search for more solutions<br>" +
                    "   }<br>" +
                    "   else if (sudo[r][n] != 0) {     //check to skip already filled cells<br>" +
                    "       return (solver(r, n + 1));  //recursive call with n + 1 to skip a filled cell<br>" +
                    "   }<br>" +
                    "   else {      //condition for an empty cell<br> " +
                    "       while (i <= 9) {    //loop to see if any 1-9 value fits<br>" +
                    "           sudo[r][n] = i;     //current cell gets i value<br>" +
                    "           if (valid(r, n) == 1) {     //helper function call to see if current number fits<br>" +
                    "               if (solver(r, n + 1) == 1) {    //recursive call inside the if condition<br>" +
                    "                   return 1;   //leftover from an earlier implementation, cannot happen<br>" +
                    "               }<br>" +
                    "           }<br>" +
                    "           sudo[r][n] = 0;     //resets current cell to default state<br>" +
                    "           i++;<br>" +
                    "       }<br>" +
                    "   }<br>" +
                    "   return 0;   //no number 1-9 fit, returning fail state to terminate this branch<br>" +
                    "}<br>//after this function has run its course another function checks solutions counter and acts accordingly"
            }
            document.getElementById("codeDisplay").innerHTML = teksti;
        }

    </script>
</body>

</html>